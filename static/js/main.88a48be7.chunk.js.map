{"version":3,"sources":["UseSignalExample.tsx","UseListenerExample.tsx","App.tsx","index.tsx","../../node_modules/@yoieh/signal/lib/Signal.js","../../node_modules/@yoieh/signal/lib/SignalListener.js","../../node_modules/@yoieh/signal/lib/index.js","../../src/hooks/useSignal.tsx","../../src/hooks/useListener.tsx"],"names":["UseSignalExample","useState","dispacheLog","setDispacheLog","count","setCount","signal","useSignal","funk","useCallback","data","pre","newCount","preLog","useEffect","add","type","onClick","dispatch","listeners","length","console","log","map","item","index","key","remove","removeAll","UseListenerExample","listener","useListener","dispose","App","ReactDOM","render","document","getElementById","Object","defineProperty","exports","value","Signal","this","prototype","push","filter","l","args","_i","arguments","forEach","apply","SignalListener","__importDefault","mod","__esModule","enumerable","get","Signal_1","default","SignalListener_1","setSignal","setListeners","fn","useMemo"],"mappings":"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","file":"static/js/main.88a48be7.chunk.js","sourcesContent":["import React, { useState, useCallback, useEffect } from 'react'\nimport { useSignal } from '@yoieh/use-signal'\n\nexport const UseSignalExample = () => {\n  const [dispacheLog, setDispacheLog] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const signal = useSignal<any>()\n\n  const funk = useCallback((data: string) => {\n    setCount((pre) => {\n      const newCount = pre + 1\n      setDispacheLog((preLog) => [\n        ...preLog,\n        `dispatched: ${data}, changed :${pre} => ${newCount}`\n      ])\n\n      return pre + 1\n    })\n  }, [])\n\n  useEffect(() => {\n    signal.add(funk)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return (\n    <div>\n      <div>\n        {count}\n        <button\n          type='button'\n          onClick={() => {\n            setDispacheLog([])\n            signal.dispatch(count)\n          }}\n        >\n          dispatch\n        </button>\n      </div>\n\n      <div>\n        {signal.listeners.length}\n        <button\n          type='button'\n          onClick={() => {\n            console.log('Add')\n            signal.add(funk)\n          }}\n        >\n          add\n        </button>\n      </div>\n\n      <div>\n        {dispacheLog.map((item, index) => (\n          <div key={index}>\n            <button\n              type='button'\n              onClick={() => {\n                signal.remove(signal.listeners[index])\n              }}\n            >\n              remove\n            </button>\n            {item}\n          </div>\n        ))}\n      </div>\n\n      <div>\n        <button type='button' onClick={() => signal.removeAll()}>\n          removeAll\n        </button>\n      </div>\n    </div>\n  )\n}\n","import React, { useCallback, useState } from 'react'\nimport { useListener, useSignal } from '@yoieh/use-signal'\n\nexport const UseListenerExample = () => {\n  const [dispacheLog, setDispacheLog] = useState<string[]>([])\n  const [count, setCount] = useState(0)\n\n  const signal = useSignal()\n\n  const funk = useCallback((data: string) => {\n    setCount((pre) => {\n      const newCount = pre + 1\n      setDispacheLog((preLog) => [\n        ...preLog,\n        `dispatched: ${data}, changed :${pre} => ${newCount}`\n      ])\n\n      return pre + 1\n    })\n  }, [])\n\n  const listener = useListener(signal, funk)\n\n  return (\n    <div>\n      <div>\n        {count}\n        <button\n          type='button'\n          onClick={() => {\n            setDispacheLog([])\n            signal.dispatch(count)\n          }}\n        >\n          dispatch\n        </button>\n      </div>\n\n      <div>\n        {signal.listeners.length}\n        <button\n          type='button'\n          onClick={() => {\n            console.log('Dispose')\n            listener.dispose()\n          }}\n        >\n          dispose\n        </button>\n      </div>\n\n      <div>\n        {dispacheLog.map((item, index) => (\n          <div key={index}>{item}</div>\n        ))}\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { UseSignalExample } from './UseSignalExample'\nimport { UseListenerExample } from './UseListenerExample'\n\nconst App = () => {\n  return (\n    <div>\n      <div>\n        <h3>UseSignalExample</h3>\n        <UseSignalExample></UseSignalExample>\n      </div>\n      <div>\n        <h3>UseListenerExample</h3>\n        <UseListenerExample></UseListenerExample>\n      </div>\n    </div>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Signal = void 0;\nvar Signal = /** @class */ (function () {\n    function Signal() {\n        this.listeners = [];\n    }\n    Signal.prototype.add = function (listener) {\n        this.listeners.push(listener);\n    };\n    Signal.prototype.remove = function (listener) {\n        this.listeners = this.listeners.filter(function (l) { return l !== listener; });\n    };\n    Signal.prototype.removeAll = function () {\n        this.listeners = [];\n    };\n    Signal.prototype.dispatch = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        this.listeners.forEach(function (l) {\n            l.apply(void 0, args);\n        });\n    };\n    return Signal;\n}());\nexports.Signal = Signal;\nexports.default = Signal;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SignalListener = void 0;\nvar SignalListener = /** @class */ (function () {\n    function SignalListener(signal, listener) {\n        this.signal = signal;\n        this.listener = listener;\n        this.signal.add(this.listener);\n    }\n    SignalListener.prototype.dispose = function () {\n        this.signal.remove(this.listener);\n    };\n    return SignalListener;\n}());\nexports.SignalListener = SignalListener;\nexports.default = SignalListener;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SignalListener = exports.Signal = void 0;\nvar Signal_1 = require(\"./Signal\");\nObject.defineProperty(exports, \"Signal\", { enumerable: true, get: function () { return __importDefault(Signal_1).default; } });\nvar SignalListener_1 = require(\"./SignalListener\");\nObject.defineProperty(exports, \"SignalListener\", { enumerable: true, get: function () { return __importDefault(SignalListener_1).default; } });\n","import { Signal } from '@yoieh/signal'\nimport { useCallback, useState } from 'react'\n\nexport function useSignal<Listener extends (...args: any[]) => any>() {\n  const [signal, setSignal] = useState(new Signal<Listener>())\n\n  const [listeners, setListeners] = useState(signal.listeners)\n\n  const dispatch = useCallback(signal.dispatch, [signal])\n  const add = useCallback(\n    (arg) => {\n      signal.add(arg)\n\n      setSignal(signal)\n      setListeners(signal.listeners)\n    },\n    [signal]\n  )\n\n  const remove = useCallback(\n    (listener) => {\n      signal.remove(listener)\n\n      setSignal(signal)\n      setListeners(signal.listeners)\n    },\n    [signal]\n  )\n\n  const removeAll = useCallback(() => {\n    signal.removeAll()\n\n    setSignal(signal)\n    setListeners(signal.listeners)\n  }, [signal])\n\n  return { dispatch, add, remove, removeAll, listeners }\n}\nexport default useSignal\n","// eslint-disable-next-line no-unused-vars\nimport { Signal, SignalListener } from '@yoieh/signal'\nimport { useCallback, useMemo } from 'react'\n\nexport function useListener<Listener extends (...args: any[]) => any>(\n  signal: Signal<Listener>,\n  fn: Listener\n) {\n  const listener = useMemo(() => new SignalListener<Listener>(signal, fn), [])\n\n  const dispose = useCallback(() => {\n    return listener.dispose()\n  }, [listener])\n\n  return { dispose, listener }\n}\nexport default useListener\n"],"sourceRoot":""}